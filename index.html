<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexFlow - Legal AI Assistant</title>
    <meta name="description"
        content="Intelligent legal assistant with integrated Chrome AI (Gemini Nano) for legal text analysis">
    <meta name="keywords" content="legal, law, AI, Gemini Nano, legal analysis, lawyer">
    <link rel="icon" href="assets/lexflow.ico" type="image/x-icon">
    <link rel="stylesheet" href="src/styles/main.css">
</head>

<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                ‚öñÔ∏è LexFlow
            </div>
            <div class="user-info">
                <span>üë§ <span id="user-name">User</span></span>
                <span>|</span>
                <span>üìç <span id="user-location">Location</span></span>
                <button class="settings-btn" id="settings-btn" title="Settings">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="main-nav">
            <button class="nav-tab active" data-view="home">üè† Home</button>
            <button class="nav-tab" data-view="workspace">üìö Legal Workspace</button>
            <button class="nav-tab" data-view="collector">üìù Collector & Curation</button>
            <button class="nav-tab" data-view="history">üìä History & Analytics</button>
        </nav>

        <!-- Content -->
        <main class="content">
            <!-- Home View -->
            <div id="home-view" class="view active">
                <div class="welcome-section">
                    <h1 class="welcome-title">Welcome to LexFlow</h1>
                    <p class="welcome-subtitle">Your intelligent legal assistant with integrated AI</p>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="stat-analyses">0</div>
                            <div class="stat-label">Analyses Performed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stat-documents">0</div>
                            <div class="stat-label">Curated Documents</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="stat-time">0h</div>
                            <div class="stat-label">Time Saved</div>
                        </div>
                    </div>
                </div>

                <div class="feature-grid">
                    <div class="feature-card" data-navigate="workspace">
                        <div class="feature-icon">üîç</div>
                        <div class="feature-title">Legal Research and Analysis</div>
                        <div class="feature-description">
                            Search laws by jurisdiction, select relevant articles, and generate personalized legal analyses with AI. Ideal for doctrinal research and documenting legal arguments.
                        </div>
                    </div>

                    <div class="feature-card" data-navigate="collector">
                        <div class="feature-icon">üìã</div>
                        <div class="feature-title">Content Curation</div>
                        <div class="feature-description">
                            Capture legal content from the web, organize it with metadata, and generate structured documents for your knowledge base or public repository.
                        </div>
                    </div>

                    <div class="feature-card" data-navigate="history">
                        <div class="feature-icon">üìà</div>
                        <div class="feature-title">Analytics & History</div>
                        <div class="feature-description">
                            Track your analytics, reuse effective prompts, and monitor your legal productivity with detailed metrics.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workspace View -->
            <div id="workspace-view" class="view">
                <!-- Step Navigation Pills -->
                <div class="step-navigation">
                    <div class="step-pill active" data-step="laws-articles">
                        üìö Laws & Articles
                    </div>
                    <div class="step-pill" data-step="prompt-studio">
                        ü§ñ Prompt Studio
                    </div>
                </div>

                <!-- Step 1: Laws & Articles -->
                <div id="step-laws-articles" class="workspace-step active">
                    <div class="workspace-container">
                        <!-- Left Panel: Available Documents -->
                        <div class="sidebar">
                            <div class="section-title">
                                üìö Available Documents
                            </div>

                            <div class="document-list" id="document-list">
                                <div class="loading-state" id="documents-loading">
                                    <div class="spinner"></div>
                                    Loading documents...
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 1rem;">
                                <label class="form-label">üîç Search Articles</label>
                                <input type="text" class="form-control" id="search-input"
                                    placeholder="Search articles...">
                            </div>
                        </div>

                        <!-- Right Panel: Selected Articles -->
                        <div class="main-panel">
                            <div class="section-title">
                                üìñ Article Selection
                            </div>

                            <div class="articles-container" id="articles-container">
                                <div class="empty-state">
                                    <p>Select a document on the left to view available articles</p>
                                </div>
                            </div>

                            <div class="selected-context" id="selected-context" style="display: none;">
                                <div class="section-title">
                                    ‚úÖ Selected Articles
                                    <button class="clear-all-btn" id="clear-all-articles" title="Clear all articles">
                                        üóëÔ∏è Clear All
                                    </button>
                                </div>
                                <div id="context-items"></div>
                            </div>

                            <div class="step-actions">
                                <button class="btn btn-primary" id="go-to-prompt-studio" disabled>
                                    Go to Prompt Studio ‚Üí
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Prompt Studio -->
                <div id="step-prompt-studio" class="workspace-step">
                    <div class="prompt-studio-layout">
                        <div class="section-title" style="grid-column: 1 / -1;">
                            ü§ñ Prompt Studio
                        </div>

                        <!-- Left Column: Context & Configuration -->
                        <div class="prompt-left-panel">
                            <div class="context-preview" id="context-preview">
                                <div class="section-title">Selected Context</div>
                                <div id="context-summary"></div>
                            </div>

                            <div class="preset-section">
                                <div class="section-title">Analysis Templates</div>
                                <div class="preset-buttons">
                                    <button class="preset-btn active" data-preset="executive-summary">
                                        üìù Executive Summary
                                    </button>
                                    <button class="preset-btn" data-preset="legal-analysis">
                                        üîç Legal Analysis
                                    </button>
                                    <button class="preset-btn" data-preset="legal-comparison">
                                        ‚öñÔ∏è Legal Comparison
                                    </button>
                                    <button class="preset-btn" data-preset="clause-generation">
                                        üìã Clause Generation
                                    </button>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Custom Prompt</label>
                                <textarea class="form-control" rows="6" id="custom-prompt"
                                    placeholder="Describe what you would like the AI to analyze...">Create an executive summary of the selected articles, highlighting the main rights and obligations, using accessible language for presentation to the client.</textarea>
                            </div>

                            <div class="prompt-actions">
                                <button class="btn btn-primary" id="execute-ai-btn">
                                    üöÄ Perform Analysis with AI
                                </button>
                                <button class="btn btn-secondary" id="send-to-curation" style="display: none;">
                                    üìù Send to Curation
                                </button>
                            </div>
                        </div>

                        <!-- Right Column: AI Output & Results -->
                        <div class="prompt-right-panel">
                            <div class="section-title">AI Analysis Results</div>
                            
                            <div class="ai-output-container">
                                <div class="ai-output" id="ai-output" style="display: none;">
                                    <div class="ai-thinking" id="ai-thinking">
                                        <div class="spinner"></div>
                                        Analyzing with AI...
                                    </div>
                                    <div id="ai-result" style="display: none;">
                                        <div id="result-content"></div>
                                        <div class="result-actions">
                                            <div class="feedback-buttons">
                                                <button class="feedback-btn" data-feedback="positive"
                                                    title="Useful result">
                                                    üëç
                                                </button>
                                                <button class="feedback-btn" data-feedback="negative"
                                                    title="Non-useful result">
                                                    üëé
                                                </button>
                                            </div>
                                            <button class="copy-btn" id="copy-result-btn" title="Copy result">
                                                üìã Copy
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="ai-placeholder" id="ai-placeholder">
                                    <div class="placeholder-content">
                                        <div class="placeholder-icon">ü§ñ</div>
                                        <h3>Ready for AI Analysis</h3>
                                        <p>Select a template or write a custom prompt, then click "Perform Analysis with AI" to get started.</p>
                                        <div class="placeholder-features">
                                            <div class="feature-item">
                                                <span class="feature-icon">‚ö°</span>
                                                <span>Chrome Built-in AI (Gemini Nano)</span>
                                            </div>
                                            <div class="feature-item">
                                                <span class="feature-icon">üîí</span>
                                                <span>Privacy-focused local processing</span>
                                            </div>
                                            <div class="feature-item">
                                                <span class="feature-icon">üìä</span>
                                                <span>Structured legal analysis</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bottom Navigation -->
                        <div class="step-actions" style="grid-column: 1 / -1;">
                            <button class="btn btn-secondary" id="back-to-articles">
                                ‚Üê Back to Articles
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Collector View -->
            <div id="collector-view" class="view">
                <div class="section-title">
                    üìù Content Collection and Curation
                </div>

                <div class="collector-grid">
                    <div>
                        <div class="section-title">üì• Capture Queue (<span id="queue-count">0</span> items)</div>
                        <div id="queue-items">
                            <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                                No items in queue. Use the "Add Content" button to get started.
                            </p>
                        </div>
                        <button class="btn btn-primary" id="add-sample-content" style="margin-top: 1rem;">
                            ‚ûï Add Sample Content
                        </button>
                    </div>

                    <div class="editor-panel">
                        <div class="section-title">‚úèÔ∏è Metadata Editor</div>

                        <div class="metadata-form" id="metadata-form">
                            <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                                Select an item from the queue to edit
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History View -->
            <div id="history-view" class="view">
                <div class="section-title">
                    üìä History & Analytics
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="history-analyses">{{n}}</div>
                        <div class="stat-label">AI Analytics</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="history-documents">{{n}}</div>
                        <div class="stat-label">Generated documents</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="history-articles">{{n}}</div>
                        <div class="stat-label">Consulted Articles</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{n}}</div>
                        <div class="stat-label">AI Accuracy</div>
                    </div>
                </div>

                <div class="section-title" style="margin-top: 2rem;">
                    üïí Recent Analysis
                </div>

                <div id="history-items">
                    <p style="color: #7f8c8d; text-align: center; padding: 2rem;">
                        No analysis performed yet. Use the Legal Workspace to get started.
                    </p>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è Settings</h3>
                <button class="modal-close" id="settings-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Language</label>
                    <select class="form-control" id="settings-language">
                        <option value="en-US">English (US)</option>
                        <option value="pt-BR">Portugu√™s (Brasil)</option>
                        <option value="es-ES">Espa√±ol</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Country</label>
                    <input type="text" class="form-control" id="settings-country" placeholder="e.g., United States">
                </div>

                <div class="form-group">
                    <label class="form-label">State/Province</label>
                    <input type="text" class="form-control" id="settings-state" placeholder="e.g., California">
                </div>

                <div class="form-group">
                    <label class="form-label">City</label>
                    <input type="text" class="form-control" id="settings-city" placeholder="e.g., San Francisco">
                </div>

                <div class="form-group">
                    <label class="form-label">Serverless Endpoint (Worker URL)</label>
                    <input type="url" class="form-control" id="settings-endpoint"
                        value="https://lexflow-corpus.webmaster-1d0.workers.dev"
                        placeholder="https://your-worker.workers.dev">
                    <small class="form-text">Cloudflare Worker endpoint for corpus submissions</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="settings-cancel">Cancel</button>
                <button class="btn btn-primary" id="settings-save">Save</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script type="module" src="src/js/app.js"></script>
</body>

</html>